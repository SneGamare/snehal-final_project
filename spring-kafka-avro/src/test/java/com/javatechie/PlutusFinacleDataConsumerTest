package com.javatechie.consumer;

import com.javatechie.dto.PlutusFinacleData;
import com.javatechie.entity.PlutusFinacleDataEntity;
import com.javatechie.repository.PlutusFinacleDataRepository;
import org.apache.kafka.clients.consumer.ConsumerRecord;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;

import static org.mockito.Mockito.*;

public class PlutusFinacleDataConsumerTest {

    @Mock
    private PlutusFinacleDataRepository repository;

    @InjectMocks
    private PlutusFinacleDataConsumer consumer;

    @BeforeEach
    void setup() {
        MockitoAnnotations.openMocks(this);
    }

    @Test
    void shouldSavePlutusFinacleDataToDatabase() {
        PlutusFinacleData data = new PlutusFinacleData();
        data.setTranId("TX123");
        data.setAcctName("John Doe");
        data.setTranAmt(5000.0);
        // Set other fields...

        ConsumerRecord<String, PlutusFinacleData> record = new ConsumerRecord<>("plutus-finacle-topic", 0, 0, "key", data);
        consumer.consume(record);

        verify(repository, times(1)).save(any(PlutusFinacleDataEntity.class));
    }
}
